{"version":3,"file":"angular2-diff-match-patch.umd.js","sources":["../../src/dmp.service.ts","../../src/line-diff.component.ts","../../src/ng2-diff.module.ts","../../src/angular2-diff-match-patch.ts"],"sourcesContent":["import * as diff_match_patch from 'google-diff-match-patch/diff_match_patch_uncompressed';\n\nexport class DiffMatchPachService {\n    private static displayType:any = {\n        INSDEL: 0,\n        LINEDIFF: 1\n    };\n\n    private diffClass(op) {\n        switch (op) {\n            case diff_match_patch.DIFF_INSERT:\n                return 'ins';\n            case diff_match_patch.DIFF_DELETE:\n                return 'del';\n            default: // case DIFF_EQUAL:\n                return 'match';\n        }\n    }\n\n    private diffSymbol(op) {\n        switch (op) {\n            case diff_match_patch.DIFF_INSERT:\n                return '+';\n            case diff_match_patch.DIFF_DELETE:\n                return '-';\n            default: // case DIFF_EQUAL:\n                return ' ';\n        }\n    }\n\n    private diffTag(op) {\n        switch (op) {\n            case diff_match_patch.DIFF_INSERT:\n                return 'ins';\n            case diff_match_patch.DIFF_DELETE:\n                return 'del';\n            default: // case DIFF_EQUAL:\n                return 'span';\n        }\n    }\n\n    private diffAttrName(op) {\n        switch (op) {\n            case diff_match_patch.DIFF_INSERT:\n                return 'insert';\n            case diff_match_patch.DIFF_DELETE:\n                return 'delete';\n            default: // case DIFF_EQUAL:\n                return 'equal';\n        }\n    }\n\n    private isEmptyObject(o) {\n        return Object.getOwnPropertyNames(o).length === 0;\n    }\n\n    private isDefined(o) {\n        return o != undefined;\n    }\n\n    private getTagAttrs(options, op, attrs?) {\n        var attributes = attrs || {};\n        var tagOptions = {};\n        var attribute;\n        var tagOption;\n        var retVal:string[] = [];\n\n        if (options != undefined && options.attrs != undefined) {\n            tagOptions = Object.assign(options.attrs[this.diffAttrName(op)] || {});\n        }\n\n        if (this.isEmptyObject(tagOptions) && this.isEmptyObject(attributes)) {\n            return '';\n        }\n\n        for (attribute in attributes) {\n            if (this.isDefined(tagOptions[attribute])) {\n                // The attribute defined in attributes should be first\n                tagOptions[attribute] = attributes[attribute] + ' ' + tagOptions[attribute];\n            } else {\n                tagOptions[attribute] = attributes[attribute];\n            }\n        }\n\n        /* eslint guard-for-in: \"off\" */\n        for (tagOption in tagOptions) {\n            retVal.push(tagOption + '=\"' + tagOptions[tagOption] + '\"');\n        }\n        return ' ' + retVal.join(' ');\n    }\n\n    private getHtmlPrefix(op, display, options) {\n        switch (display) {\n            case DiffMatchPachService.displayType.LINEDIFF:\n                return '<div class=\"' + this.diffClass(op) + '\"><span' + this.getTagAttrs(options, op, {class: 'noselect'}) + '>' + this.diffSymbol(op) + '</span>';\n            default: // case displayType.INSDEL:\n                return '<' + this.diffTag(op) + this.getTagAttrs(options, op) + '>';\n        }\n    }\n\n    private getHtmlSuffix(op, display) {\n        switch (display) {\n            case DiffMatchPachService.displayType.LINEDIFF:\n                return '</div>';\n            default: // case displayType.INSDEL:\n                return '</' + this.diffTag(op) + '>';\n        }\n    }\n\n    private createHtmlLines(text, op, options) {\n        var lines = text.split('\\n');\n        var y;\n        for (y = 0; y < lines.length; y++) {\n            if (lines[y].length === 0) {\n                continue;\n            }\n            lines[y] = this.getHtmlPrefix(op, DiffMatchPachService.displayType.LINEDIFF, options) + lines[y] + this.getHtmlSuffix(op, DiffMatchPachService.displayType.LINEDIFF);\n        }\n        return lines.join('');\n    }\n\n    private createHtmlFromDiffs(diffs, display, options) {\n        var patternAmp = /&/g;\n        var patternLt = /</g;\n        var patternGt = />/g;\n        var x;\n        var html:string[] = [];\n        var y;\n        var data;\n        var op;\n        var text;\n        var diffData = diffs;\n\n        for (x = 0; x < diffData.length; x++) {\n            data = diffData[x][1];\n            diffData[x][1] = data.replace(patternAmp, '&amp;')\n                .replace(patternLt, '&lt;')\n                .replace(patternGt, '&gt;');\n        }\n\n        for (y = 0; y < diffData.length; y++) {\n            op = diffData[y][0];\n            text = diffData[y][1];\n            if (display === DiffMatchPachService.displayType.LINEDIFF) {\n                html[y] = this.createHtmlLines(text, op, options);\n            } else {\n                html[y] = this.getHtmlPrefix(op, display, options) + text + this.getHtmlSuffix(op, display);\n            }\n        }\n        return html.join('');\n    }\n\n    private isString(myVar) {\n        return (typeof myVar === 'string' || myVar instanceof String);\n    }\n\n    private assertArgumentsIsStrings(left, right) {\n        return this.isString(left) && this.isString(right);\n    }\n\n    public createDiffHtml(left, right, options) {\n        var dmp;\n        var diffs;\n        if (this.assertArgumentsIsStrings(left, right)) {\n            dmp = new diff_match_patch.diff_match_patch();\n            diffs = dmp.diff_main(left, right);\n            return this.createHtmlFromDiffs(diffs, DiffMatchPachService.displayType.INSDEL, options);\n        }\n        return '';\n    }\n\n//    createProcessingDiffHtml: function createProcessingDiffHtml(left, right, options) {\n//    var dmp;\n//    var diffs;\n//    if (assertArgumentsIsStrings(left, right)) {\n//        dmp = new diff_match_patch();\n//        diffs = dmp.diff_main(left, right);\n//\n//        if (angular.isDefined(options) && angular.isDefined(options.editCost) && isFinite(options.editCost)) {\n//            dmp.Diff_EditCost = options.editCost; // eslint-disable-line camelcase\n//        }\n//\n//        dmp.diff_cleanupEfficiency(diffs);\n//        return createHtmlFromDiffs(diffs, displayType.INSDEL, options);\n//    }\n//    return '';\n//},\n//\n//    createSemanticDiffHtml: function createSemanticDiffHtml(left, right, options) {\n//    var dmp;\n//    var diffs;\n//    if (assertArgumentsIsStrings(left, right)) {\n//        dmp = new diff_match_patch();\n//        diffs = dmp.diff_main(left, right);\n//        dmp.diff_cleanupSemantic(diffs);\n//        return createHtmlFromDiffs(diffs, displayType.INSDEL, options);\n//    }\n//    return '';\n//},\n\n    public createLineDiffHtml(left, right, options) {\n        var dmp;\n        var chars;\n        var diffs;\n        if (this.assertArgumentsIsStrings(left, right)) {\n            dmp = new diff_match_patch.diff_match_patch();\n            chars = dmp.diff_linesToChars_(left, right);\n            diffs = dmp.diff_main(chars.chars1, chars.chars2, false);\n            dmp.diff_charsToLines_(diffs, chars.lineArray);\n            return this.createHtmlFromDiffs(diffs, DiffMatchPachService.displayType.LINEDIFF, options);\n        }\n        return '';\n    }\n}\n","import {Directive, Input, SimpleChanges, ElementRef, OnInit, OnChanges}         from '@angular/core';\n\nimport {DiffMatchPachService} from './dmp.service';\n\n@Directive({\n    selector: '[line-diff]',\n    providers: [\n        DiffMatchPachService\n    ]\n})\nexport class LineDiffComponent implements OnInit, OnChanges {\n    @Input() left:string;\n    @Input() right:string;\n    @Input() options:{} = {};\n\n    constructor(private el:ElementRef, private dmp:DiffMatchPachService) {\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        this.el.nativeElement.innerHTML = this.dmp.createLineDiffHtml(this.left, this.right, this.options);\n    }\n\n    public ngOnInit() {\n        this.el.nativeElement.innerHTML = this.dmp.createLineDiffHtml(this.left, this.right, this.options);\n    }\n}\n","import {LineDiffComponent} from './line-diff.component';\n\n// (<any>window).diff_match_patch = require('google-diff-match-patch/diff_match_patch_uncompressed');\n\nimport {NgModule} from '@angular/core';\n\n@NgModule({\n    exports: [\n        LineDiffComponent\n    ],\n    declarations: [\n        LineDiffComponent\n    ],\n    imports: []\n})\nexport class Ng2DiffModule {\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["diff_match_patch.DIFF_INSERT","diff_match_patch.DIFF_DELETE","diff_match_patch.diff_match_patch","Directive","Input","NgModule"],"mappings":"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"}