{"version":3,"sources":["ng://angular2-diff-match-patch/dmp.service.ts","ng://angular2-diff-match-patch/line-diff.component.ts","ng://angular2-diff-match-patch/ng2-diff.module.ts"],"names":["DiffMatchPachService","prototype","diffClass","op","diff_match_patch","DIFF_INSERT","DIFF_DELETE","diffSymbol","diffTag","diffAttrName","isEmptyObject","o","Object","getOwnPropertyNames","length","isDefined","undefined","getTagAttrs","options","attrs","attribute","tagOption","attributes","tagOptions","retVal","assign","this","push","join","getHtmlPrefix","display","displayType","LINEDIFF","class","getHtmlSuffix","createHtmlLines","text","y","lines","split","createHtmlFromDiffs","diffs","x","data","patternAmp","patternLt","patternGt","html","diffData","replace","isString","myVar","String","assertArgumentsIsStrings","left","right","createDiffHtml","diff_main","INSDEL","createLineDiffHtml","dmp","chars","diff_linesToChars_","chars1","chars2","diff_charsToLines_","lineArray","LineDiffComponent","el","ngOnChanges","changes","nativeElement","innerHTML","ngOnInit","Directive","args","selector","providers","ElementRef","Input","Ng2DiffModule","NgModule","exports","declarations","imports"],"mappings":"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","sourcesContent":["export class DiffMatchPachService {\n    private static displayType:any = {\n        INSDEL: 0,\n        LINEDIFF: 1\n    };\n\n    private diffClass(op) {\n        switch (op) {\n            case (<any>window).diff_match_patch.DIFF_INSERT:\n                return 'ins';\n            case (<any>window).diff_match_patch.DIFF_DELETE:\n                return 'del';\n            default: // case DIFF_EQUAL:\n                return 'match';\n        }\n    }\n\n    private diffSymbol(op) {\n        switch (op) {\n            case (<any>window).diff_match_patch.DIFF_INSERT:\n                return '+';\n            case (<any>window).diff_match_patch.DIFF_DELETE:\n                return '-';\n            default: // case DIFF_EQUAL:\n                return ' ';\n        }\n    }\n\n    private diffTag(op) {\n        switch (op) {\n            case (<any>window).diff_match_patch.DIFF_INSERT:\n                return 'ins';\n            case (<any>window).diff_match_patch.DIFF_DELETE:\n                return 'del';\n            default: // case DIFF_EQUAL:\n                return 'span';\n        }\n    }\n\n    private diffAttrName(op) {\n        switch (op) {\n            case (<any>window).diff_match_patch.DIFF_INSERT:\n                return 'insert';\n            case (<any>window).diff_match_patch.DIFF_DELETE:\n                return 'delete';\n            default: // case DIFF_EQUAL:\n                return 'equal';\n        }\n    }\n\n    private isEmptyObject(o) {\n        return Object.getOwnPropertyNames(o).length === 0;\n    }\n\n    private isDefined(o) {\n        return o != undefined;\n    }\n\n    private getTagAttrs(options, op, attrs?) {\n        var attributes = attrs || {};\n        var tagOptions = {};\n        var attribute;\n        var tagOption;\n        var retVal = [];\n\n        if (options != undefined && options.attrs != undefined) {\n            tagOptions = Object.assign(options.attrs[this.diffAttrName(op)] || {});\n        }\n\n        if (this.isEmptyObject(tagOptions) && this.isEmptyObject(attributes)) {\n            return '';\n        }\n\n        for (attribute in attributes) {\n            if (this.isDefined(tagOptions[attribute])) {\n                // The attribute defined in attributes should be first\n                tagOptions[attribute] = attributes[attribute] + ' ' + tagOptions[attribute];\n            } else {\n                tagOptions[attribute] = attributes[attribute];\n            }\n        }\n\n        /* eslint guard-for-in: \"off\" */\n        for (tagOption in tagOptions) {\n            retVal.push(tagOption + '=\"' + tagOptions[tagOption] + '\"');\n        }\n        return ' ' + retVal.join(' ');\n    }\n\n    private getHtmlPrefix(op, display, options) {\n        switch (display) {\n            case DiffMatchPachService.displayType.LINEDIFF:\n                return '<div class=\"' + this.diffClass(op) + '\"><span' + this.getTagAttrs(options, op, {class: 'noselect'}) + '>' + this.diffSymbol(op) + '</span>';\n            default: // case displayType.INSDEL:\n                return '<' + this.diffTag(op) + this.getTagAttrs(options, op) + '>';\n        }\n    }\n\n    private getHtmlSuffix(op, display) {\n        switch (display) {\n            case DiffMatchPachService.displayType.LINEDIFF:\n                return '</div>';\n            default: // case displayType.INSDEL:\n                return '</' + this.diffTag(op) + '>';\n        }\n    }\n\n    private createHtmlLines(text, op, options) {\n        var lines = text.split('\\n');\n        var y;\n        for (y = 0; y < lines.length; y++) {\n            if (lines[y].length === 0) {\n                continue;\n            }\n            lines[y] = this.getHtmlPrefix(op, DiffMatchPachService.displayType.LINEDIFF, options) + lines[y] + this.getHtmlSuffix(op, DiffMatchPachService.displayType.LINEDIFF);\n        }\n        return lines.join('');\n    }\n\n    private createHtmlFromDiffs(diffs, display, options) {\n        var patternAmp = /&/g;\n        var patternLt = /</g;\n        var patternGt = />/g;\n        var x;\n        var html = [];\n        var y;\n        var data;\n        var op;\n        var text;\n        var diffData = diffs;\n\n        for (x = 0; x < diffData.length; x++) {\n            data = diffData[x][1];\n            diffData[x][1] = data.replace(patternAmp, '&amp;')\n                .replace(patternLt, '&lt;')\n                .replace(patternGt, '&gt;');\n        }\n\n        for (y = 0; y < diffData.length; y++) {\n            op = diffData[y][0];\n            text = diffData[y][1];\n            if (display === DiffMatchPachService.displayType.LINEDIFF) {\n                html[y] = this.createHtmlLines(text, op, options);\n            } else {\n                html[y] = this.getHtmlPrefix(op, display, options) + text + this.getHtmlSuffix(op, display);\n            }\n        }\n        return html.join('');\n    }\n\n    private isString(myVar) {\n        return (typeof myVar === 'string' || myVar instanceof String);\n    }\n\n    private assertArgumentsIsStrings(left, right) {\n        return this.isString(left) && this.isString(right);\n    }\n\n    public createDiffHtml(left, right, options) {\n        var dmp;\n        var diffs;\n        if (this.assertArgumentsIsStrings(left, right)) {\n            dmp = new (<any>window).diff_match_patch.diff_match_patch();\n            diffs = dmp.diff_main(left, right);\n            return this.createHtmlFromDiffs(diffs, DiffMatchPachService.displayType.INSDEL, options);\n        }\n        return '';\n    }\n\n//    createProcessingDiffHtml: function createProcessingDiffHtml(left, right, options) {\n//    var dmp;\n//    var diffs;\n//    if (assertArgumentsIsStrings(left, right)) {\n//        dmp = new (<any>window).diff_match_patch();\n//        diffs = dmp.diff_main(left, right);\n//\n//        if (angular.isDefined(options) && angular.isDefined(options.editCost) && isFinite(options.editCost)) {\n//            dmp.Diff_EditCost = options.editCost; // eslint-disable-line camelcase\n//        }\n//\n//        dmp.diff_cleanupEfficiency(diffs);\n//        return createHtmlFromDiffs(diffs, displayType.INSDEL, options);\n//    }\n//    return '';\n//},\n//\n//    createSemanticDiffHtml: function createSemanticDiffHtml(left, right, options) {\n//    var dmp;\n//    var diffs;\n//    if (assertArgumentsIsStrings(left, right)) {\n//        dmp = new (<any>window).diff_match_patch();\n//        diffs = dmp.diff_main(left, right);\n//        dmp.diff_cleanupSemantic(diffs);\n//        return createHtmlFromDiffs(diffs, displayType.INSDEL, options);\n//    }\n//    return '';\n//},\n\n    public createLineDiffHtml(left, right, options) {\n        var dmp;\n        var chars;\n        var diffs;\n        if (this.assertArgumentsIsStrings(left, right)) {\n            dmp = new (<any>window).diff_match_patch.diff_match_patch();\n            chars = dmp.diff_linesToChars_(left, right);\n            diffs = dmp.diff_main(chars.chars1, chars.chars2, false);\n            dmp.diff_charsToLines_(diffs, chars.lineArray);\n            return this.createHtmlFromDiffs(diffs, DiffMatchPachService.displayType.LINEDIFF, options);\n        }\n        return '';\n    }\n}\n","import {Directive, Input, SimpleChanges, ElementRef, OnInit, OnChanges}         from '@angular/core';\n\nimport {DiffMatchPachService} from './dmp.service';\n\n@Directive({\n    selector: '[line-diff]',\n    providers: [\n        DiffMatchPachService\n    ]\n})\nexport class LineDiffComponent implements OnInit, OnChanges {\n    @Input() left:string;\n    @Input() right:string;\n    @Input() options:{} = {};\n\n    constructor(private el:ElementRef, private dmp:DiffMatchPachService) {\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        this.el.nativeElement.innerHTML = this.dmp.createLineDiffHtml(this.left, this.right, this.options);\n    }\n\n    public ngOnInit() {\n        this.el.nativeElement.innerHTML = this.dmp.createLineDiffHtml(this.left, this.right, this.options);\n    }\n}\n","import {LineDiffComponent} from './line-diff.component';\n\nimport {NgModule} from '@angular/core';\n\n@NgModule({\n    exports: [\n        LineDiffComponent\n    ],\n    declarations: [\n        LineDiffComponent\n    ],\n    imports: []\n})\nexport class Ng2DiffModule {\n}\n"]}